<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Processing</title>   
	</head>
	<body>
		{% if MEI_filename %}
			<form action ="{% url "list" %}" method="post" enctype="multipart/form-data">
				{% csrf_token %}

				<input type="hidden" name="MEI_filename" value={{MEI_filename}} />
				Processing:
				{% autoescape off %}
				{{ MEI_filename }}<br /><br />
				{% endautoescape %}

				Leave original staves untouched, as &lsquo;variants&rsquo; of themselves.
				These staves should be at the top of the list.<br />
				<b>Warning:</b> Marking staff X as a reconstruction of staff Y
				will eliminate staff Y information.<br /><br />

				{% if staff_list %}
					{% for altStaff in staff_list %}
						Staff {{ forloop.counter }} ({{altStaff.0|escape}})
						<input type="hidden" name="staff{{forloop.counter}}" value={{altStaff.0}} />
						<input type="hidden" name="kindOfReading{{forloop.counter}}" value={{altStaff.2}} />
						is {{altStaff.2}} of staff 
						<select name="readingOf{{forloop.counter}}">
							<option value="0">(Ignore this staff)</option>
							{% for origStaff in staff_list %}
								<option value="{{forloop.counter}}"{% ifequal origStaff.0 altStaff.1 %} selected="selected"{% else %}{% endifequal %}>{{origStaff.0}}</option>
							{% endfor %}
						</select>
						from source <input type="text" name="source{{forloop.counter}}" value="{{altStaff.3}}" /><br />
					{% endfor %}

				{% else %}
					<p>No staves were detected! What a Cagian piece!</p>
				{% endif %}
				<br />

				<input type="checkbox" name="replace_longa" checked="checked" />
				Make final note longa?<br />

				<input type="checkbox" name="obliterate_incipit"
				{% if first_measure_empty %} checked="checked" {% else %}{% endif %} />
				Obliterate first measure? (Leave checked if first measure is incipit.)<br /><br />

				{% if has_editor_element %}
				<input type="hidden" name="arranger_to_editor" value="false" />
				Editor listed as &lsquo;{{editor_name}}&rsquo;.<br />
				{% else %}
				{% if has_arranger_element %}
				<input type="checkbox" name="arranger_to_editor" checked="checked" />
				Mark &lsquo;{{editor_name}}&rsquo; as editor (instead of arranger)?<br />
				{% else %}
				<input type="hidden" name="arranger_to_editor" value="false" />
				{% endif %}
				{% endif %}
				
				Responsibility for editorial accidentals: <input type="text" name="editorial_resp" />


				<p><input type="submit" name="action" value="Process" /></p>

			</form>

		{% else %}
			<p>No document selected.</p>
		{% endif %}

		<form action ="{% url "list" %}" method="post" enctype="multipart/form-data">
			{% csrf_token %}
			<input type="submit" value="Go back"/>
		</form>
	</body>
</html>